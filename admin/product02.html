<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>상품관리 / 카테고리관리</title>
<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- CSS -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" /> <!--AOS 애니메이션-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" /> <!--스와이퍼-->
<link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.css" />
<link rel="stylesheet" href="./css/admin.css" />
<link rel="stylesheet" href="./css/custom.css" />
<link rel="stylesheet" href="./css/admin.css" />
<!-- JS -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>
<script src="./js/admin.js"></script>
</head>

<body>
<div class="admin_common">
<!----======== 관리자 레이아웃 상단    ========---->
<section id="admin_header_wrap">
<div id="admin_top_area">
    <div class="user_area">
    <p class="welcome"><b>관리자</b>님 안녕하세요.</p>
    <button onclick="location.href='login.html'" type="button">로그아웃</button>
    <button onclick="location.href=''" style="background:#7F23F3;" type="button">RENTIQUE</button>
    </div>
</div>
<div id="admin_side_area">
    <div class="logo_area">
    <a href="./dashboard.html">
    <img class="logo" src="./img/logo_b.png" alt="logo.png">
    <p>ADMIN</p>
    </a>
    </div>
    <div class="side_btm_area">
    <!--메뉴-->
    <ul id="adm_nav">
        <!--DEPTH 1-->
        <li class="adm_nav_depth1"><a href="./dashboard.html"><span><i class="fa fa-home before" aria-hidden="true"></i>대시보드</span></a></li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
            <p class="adm_nav_depth1"><span><i class="fa fa-user before" aria-hidden="true"></i>회원관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
            <!--DEPTH 2-->
            <ul class="adm_nav_depth2_ul">
                <li><a href="./member01.html">일반 회원</a></li>
                <li><a href="./member02.html">탈퇴 회원</a></li>
            </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-gift before" aria-hidden="true"></i>상품관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./product01.html">상품 관리</a></li>
            <li><a href="./product02.html">카테고리 관리</a></li>
            <li><a href="./product03.html">브랜드 관리</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-shopping-basket before" aria-hidden="true"></i>주문관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./order01.html">렌트관리</a></li>
            <li><a href="./order02.html">취소관리</a></li>
            <li><a href="./order03.html">반품관리</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-shopping-bag before" aria-hidden="true"></i>위탁관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./consignment01.html">위탁관리</a></li>
            <li><a href="./consignment02.html">정산관리</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-clipboard before" aria-hidden="true"></i>콘텐츠관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./contents01.html">서비스소개</a></li>
            <li><a href="./contents02.html">기획전</a></li>
            <li><a href="./contents03.html">이벤트</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa  fa-list-alt before" aria-hidden="true"></i>게시판관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./board01.html">공지사항</a></li>
            <li><a href="./board02.html">자주하는질문</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-heart before" aria-hidden="true"></i>프로모션관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./promotions01.html">쿠폰관리</a></li>
            <li><a href="./promotions02.html">핫딜관리</a></li>
            <li><a href="./promotions03.html">적립금관리</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth1"><a href="./reveiw.html"><span><i class="fa fa-pencil before" aria-hidden="true"></i>리뷰관리</span></a></li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-lightbulb-o before" aria-hidden="true"></i>문의관리</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./inquiry01.html">상품문의</a></li>
            <li><a href="./inquiry02.html">1:1문의</a></li>
        </ul>
        </li>
        <!--DEPTH 1-->
        <li class="adm_nav_depth2_group">
        <p class="adm_nav_depth1"><span><i class="fa fa-cog before" aria-hidden="true"></i>설정</span> <i class="fa fa-sort-desc" aria-hidden="true"></i></p>
        <!--DEPTH 2-->
        <ul class="adm_nav_depth2_ul">
            <li><a href="./setting01.html">추천상품관리</a></li>
            <li><a href="./setting02.html">배너관리</a></li>
            <li><a href="./setting03.html">팝업관리</a></li>
            <li><a href="./setting04.html">계정관리</a></li>
            <li><a href="./setting05.html">기본설정</a></li>
        </ul>
        </li>
    </ul>
    </div>
</div>
<script>
$('.adm_nav_depth1').click(function() {
    $(this).siblings('.adm_nav_depth2_ul').slideToggle();
    $(this).parent().siblings().find('.adm_nav_depth2_ul').slideUp();
    $('.adm_nav_depth1').removeClass('on');
    $(this).toggleClass('on');
});
</script>
</section>
<!----======== 관리자 레이아웃 상단 끝 ========---->
<!----======== 내용부분 ========---->
<section id="admin_contents_wrap">
    <p class="title">상품관리 / 카테고리 관리 </p>
    <div class="btn_area">
        <button onclick="addCategory('depth1')">+ 대분류추가</button>
        <button onclick="saveAll()">전체완료</button>
    </div>
    <table class="table_defalt table2">
        <thead>
            <tr>
                <th colspan="3" width="120px">depth</th>
                <th width="500px">카테고리명</th>
                <th width="80px">노출여부</th>
                <th width="80px">등록일</th>
                <th width="220px">관리</th>
            </tr>
        </thead>
        <tbody id="categoryTable">
        </tbody>
    </table>
    <script>
    $(document).ready(function() {
                let categoryTable = $('#categoryTable');
                let date = new Date().toISOString().split('T')[0];

                window.addCategory = function(type, el) {
                    let newRow;
                    let parentRow = $(el).closest('tr');
                    let lastSibling;
                    if (type === 'depth1') {
                        newRow = `
                            <tr class="depth1">
                                <td colspan="3">대분류</td>
                                <td><input placeholder="카테고리명 입력"></td>
                                <td>
                                    <select>
                                        <option>노출</option>
                                        <option>숨김</option>
                                    </select>
                                </td>
                                <td>${date}</td>
                                <td class="in_btn_area">
                                    <button class="in_btn" onclick="addCategory('depth2', this)">하위 분류 추가</button>
                                    <button class="in_btn" onclick="deleteRow(this)">삭제</button>
                                    <button class="in_btn save" onclick="saveRow(this)">완료</button>
                                </td>
                            </tr>`;
                        categoryTable.append(newRow);
                    } else if (type === 'depth2') {
                        lastSibling = parentRow;
                        while (lastSibling.next().hasClass('depth2') || lastSibling.next().hasClass('depth3')) {
                            lastSibling = lastSibling.next();
                        }
                        newRow = `
                            <tr class="depth2">
                                <td class="space"></td>
                                <td colspan="2">중분류</td>
                                <td><input placeholder="카테고리명 입력"></td>
                                <td>
                                    <select>
                                        <option>노출</option>
                                        <option>숨김</option>
                                    </select>
                                </td>
                                <td>${date}</td>
                                <td class="in_btn_area">
                                    <button class="in_btn" onclick="addCategory('depth3', this)">하위 분류 추가</button>
                                    <button class="in_btn" onclick="deleteRow(this)">삭제</button>
                                    <button class="in_btn save" onclick="saveRow(this)">완료</button>
                                </td>
                            </tr>`;
                        lastSibling.after(newRow);
                    } else if (type === 'depth3') {
                        lastSibling = parentRow;
                        while (lastSibling.next().hasClass('depth3')) {
                            lastSibling = lastSibling.next();
                        }
                        newRow = `
                            <tr class="depth3">
                                <td colspan="2"></td>
                                <td>소분류</td>
                                <td><input placeholder="카테고리명 입력"></td>
                                <td>
                                    <select>
                                        <option>노출</option>
                                        <option>숨김</option>
                                    </select>
                                </td>
                                <td>${date}</td>
                                <td class="in_btn_area">
                                    <button class="in_btn" onclick="deleteRow(this)">삭제</button>
                                    <button class="in_btn save" onclick="saveRow(this)">완료</button>
                                </td>
                            </tr>`;
                        lastSibling.after(newRow);
                    }
                }

                window.deleteRow = function(el) {
                    let row = $(el).closest('tr');
                    let rowDepth = row.attr('class');
                    let nextRow = row.next();

                    let canDelete = true;

                    nextRow.each(function() {
                        let nextRowDepth = $(this).attr('class');
                        if (rowDepth === 'depth1' && nextRowDepth === 'depth2') {
                            canDelete = false;
                            return false;
                        }
                        if (rowDepth === 'depth2' && nextRowDepth === 'depth3') {
                            canDelete = false;
                            return false;
                        }
                        if (rowDepth === 'depth2' && nextRowDepth === 'depth1') {
                            return false;
                        }
                        if (rowDepth === 'depth3' && (nextRowDepth === 'depth1' || nextRowDepth === 'depth2')) {
                            return false;
                        }
                    });

                    if (canDelete) {
                        row.remove();
                    } else {
                        alert('하위 분류가 있는 카테고리는 삭제할 수 없습니다.');
                    }
                }

                window.editRow = function(el) {
                    let row = $(el).closest('tr');
                    row.find('input').prop('readonly', false);
                    row.find('select').prop('disabled', false);
                    $(el).text('완료').attr('onclick', 'saveRow(this)');
                }

                window.saveRow = function(el) {
                    let row = $(el).closest('tr');
                    row.find('input').prop('readonly', true);
                    row.find('select').prop('disabled', true);
                    $(el).text('수정').attr('onclick', 'editRow(this)');
                    alert('변경사항이 저장되었습니다.');
                }

                window.saveAll = function(){
                    categoryTable.find('input').prop('readonly', true);
                    categoryTable.find('select').prop('disabled', true);
                    categoryTable.find('button.save').text('수정').attr('onclick', 'editRow(this)');
                    alert('변경사항이 저장되었습니다.');
                }
            });
    </script>
</section>
<!----======== 내용부분 끝 ========---->
<!----======== 관리자 레이아웃 하단    ========---->
<section id="admin_footer_wrap">
<div></div>
</section>
<!----======== 관리자 레이아웃 하단 끝 ========---->
</div>
</body>
</html>